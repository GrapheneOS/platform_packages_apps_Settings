package com.android.settings.spa.app.appinfo

import android.content.pm.ApplicationInfo
import android.content.pm.GosPackageState
import androidx.compose.runtime.Composable
import androidx.compose.runtime.mutableStateOf
import androidx.compose.runtime.remember
import androidx.compose.ui.platform.LocalContext
import androidx.compose.ui.res.stringResource
import com.android.settings.R
import com.android.settings.applications.appinfo.AswExploitProtectionFragment
import com.android.settingslib.spa.framework.compose.stateOf
import com.android.settingslib.spa.widget.preference.SwitchPreference
import com.android.settingslib.spa.widget.preference.SwitchPreferenceModel
import com.android.settingslib.spaprivileged.model.app.installed

@Composable
fun AppExploitProtectionCompatModeSwitchPreference(app: ApplicationInfo,
                                                   packageInfoPresenter: PackageInfoPresenter) {
    if (app.isSystemApp || !app.installed) {
        return
    }

    val context = LocalContext.current
    val pkgName = app.packageName
    val psFlag = GosPackageState.FLAG_ENABLE_EXPLOIT_PROTECTION_COMPAT_MODE

    val psFlagState = remember {
        val initialState = GosPackageState.get(pkgName)?.hasFlag(psFlag) == true
        mutableStateOf(initialState)
    }

}
